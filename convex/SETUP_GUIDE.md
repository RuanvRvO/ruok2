# Convex Registration Setup Guide

## Files You Need to Create/Update

### 1. **convex/schema.ts** (NEW FILE)
Place the schema.ts file in your `convex/` folder

### 2. **convex/users.ts** (NEW FILE)
Place the users.ts file in your `convex/` folder

### 3. **src/app/registration/page.tsx** (UPDATE EXISTING)
Replace your existing registration page with registration-page.tsx

## Folder Structure
```
your-project/
├── convex/
│   ├── schema.ts          ← Create this
│   ├── users.ts           ← Create this
│   └── _generated/        ← Auto-generated by Convex
├── src/
│   └── app/
│       └── registration/
│           └── page.tsx   ← Update this
```

## Setup Steps

1. **Make sure Convex is running:**
   ```bash
   npx convex dev
   ```
   This should be running in your terminal. It watches for changes.

2. **Copy the files:**
   - Copy `schema.ts` to `convex/schema.ts`
   - Copy `users.ts` to `convex/users.ts`
   - Copy `registration-page.tsx` content to `src/app/registration/page.tsx`

3. **Test registration:**
   - Go to http://localhost:3000/registration
   - Fill out the form
   - Click "Register"

4. **View your data:**
   - Open Convex Dashboard: https://dashboard.convex.dev
   - Select your project
   - Go to "Data" tab
   - Click on "users" table
   - You should see your registered users!

## How It Works

### Data Flow:
```
User fills form → Click Register
    ↓
Registration Page (React)
    ↓
useMutation(api.users.registerUser)
    ↓
Convex Backend (users.ts)
    ↓
Database (users table)
    ↓
Success message back to user
```

### What Each File Does:

**schema.ts**: Defines your database structure
- Like creating a table in SQL
- Tells Convex what fields each user has
- Creates indexes for fast lookups

**users.ts**: Your backend functions
- `registerUser`: Mutation that creates new users
- `getUserByEmail`: Query to find a user (for login later)
- `getAllUsers`: Query to list all users (for admin)

**page.tsx**: Your frontend
- Uses `useMutation` hook to call Convex
- Handles form validation
- Shows success/error messages

## Important Notes

⚠️ **Security Warning**: 
- Current code stores passwords in plain text
- For production, install bcrypt:
  ```bash
  npm install bcryptjs
  npm install --save-dev @types/bcryptjs
  ```
- Then hash passwords in users.ts before storing

## Testing in Convex Dashboard

You can also test your functions directly:
1. Go to Convex Dashboard
2. Click "Functions" tab
3. Find "users:registerUser"
4. Click "Run" and enter test data:
   ```json
   {
     "name": "Test User",
     "email": "test@example.com",
     "password": "password123"
   }
   ```

## Next Steps

1. **Add Login**: Create a login page using `getUserByEmail`
2. **Add Authentication**: Use Convex Auth for sessions
3. **Hash Passwords**: Add bcrypt for security
4. **Add Validation**: More robust email/password validation

## Troubleshooting

**Error: "Cannot find module '../../../convex/_generated/api'"**
- Make sure `npx convex dev` is running
- Check that files are in the correct folders

**Registration fails silently**
- Check browser console (F12) for errors
- Check terminal where `npx convex dev` is running

**"Email already registered" error**
- This is expected if you try to register the same email twice
- Check the Convex dashboard to see existing users
